-- Initial database migration for Leiloapp
-- This script creates all the necessary tables for the auction system

-- Create extension for UUID generation
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- Tabela de Usuários (extending ASP.NET Core Identity)
CREATE TABLE usuarios (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    cpf VARCHAR(14) UNIQUE NOT NULL,
    nome VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    telefone VARCHAR(20),
    senha_hash VARCHAR(255) NOT NULL,
    tipo VARCHAR(20) NOT NULL CHECK (tipo IN ('Participante', 'Administrador', 'Leiloeiro')),
    ativo BOOLEAN DEFAULT true,
    aprovado BOOLEAN DEFAULT false,
    data_cadastro TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    ultimo_acesso TIMESTAMP WITH TIME ZONE,
    CONSTRAINT chk_cpf_format CHECK (cpf ~ '^\d{3}\.\d{3}\.\d{3}-\d{2}$')
);

-- Índices para usuários
CREATE INDEX idx_usuarios_cpf ON usuarios(cpf);
CREATE INDEX idx_usuarios_email ON usuarios(email);
CREATE INDEX idx_usuarios_tipo ON usuarios(tipo);
CREATE INDEX idx_usuarios_aprovado ON usuarios(aprovado);

-- Tabela de Leilões
CREATE TABLE leiloes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    administrador_id UUID NOT NULL REFERENCES usuarios(id),
    titulo VARCHAR(255) NOT NULL,
    descricao TEXT,
    data_inicio TIMESTAMP WITH TIME ZONE NOT NULL,
    data_termino TIMESTAMP WITH TIME ZONE NOT NULL,
    status VARCHAR(20) NOT NULL DEFAULT 'Aberto' CHECK (status IN ('Aberto', 'EmAndamento', 'Finalizado', 'Cancelado')),
    valor_arrecadado DECIMAL(15,2) DEFAULT 0,
    imagem_capa VARCHAR(500),
    data_criacao TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    CONSTRAINT chk_datas CHECK (data_termino > data_inicio)
);

-- Índices para leilões
CREATE INDEX idx_leiloes_status ON leiloes(status);
CREATE INDEX idx_leiloes_data_inicio ON leiloes(data_inicio);
CREATE INDEX idx_leiloes_data_termino ON leiloes(data_termino);

-- Tabela de Lotes
CREATE TABLE lotes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    leilao_id UUID NOT NULL REFERENCES leiloes(id) ON DELETE CASCADE,
    titulo VARCHAR(255) NOT NULL,
    descricao TEXT,
    valor_inicial DECIMAL(15,2) NOT NULL,
    valor_minimo DECIMAL(15,2) NOT NULL,
    valor_atual DECIMAL(15,2) DEFAULT 0,
    vencedor_id UUID REFERENCES usuarios(id),
    data_vencimento TIMESTAMP WITH TIME ZONE,
    status VARCHAR(20) NOT NULL DEFAULT 'Aberto' CHECK (status IN ('Aberto', 'EmLicitacao', 'Vendido', 'NaoVendido')),
    ordem_exibicao INTEGER DEFAULT 0,
    data_criacao TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    CONSTRAINT chk_valores CHECK (valor_minimo >= valor_inicial)
);

-- Índices para lotes
CREATE INDEX idx_lotes_leilao_id ON lotes(leilao_id);
CREATE INDEX idx_lotes_status ON lotes(status);
CREATE INDEX idx_lotes_vencedor_id ON lotes(vencedor_id);

-- Tabela de Lances
CREATE TABLE lances (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    lote_id UUID NOT NULL REFERENCES lotes(id) ON DELETE CASCADE,
    usuario_id UUID NOT NULL REFERENCES usuarios(id),
    valor DECIMAL(15,2) NOT NULL,
    data_hora TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    vencedor BOOLEAN DEFAULT false,
    ip_address INET,
    user_agent TEXT,
    CONSTRAINT chk_valor_positivo CHECK (valor > 0)
);

-- Índices para lances
CREATE INDEX idx_lances_lote_id ON lances(lote_id);
CREATE INDEX idx_lances_usuario_id ON lances(usuario_id);
CREATE INDEX idx_lances_data_hora ON lances(data_hora DESC);
CREATE INDEX idx_lances_vencedor ON lances(vencedor);

-- Tabela de Imagens dos Lotes
CREATE TABLE lote_imagens (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    lote_id UUID NOT NULL REFERENCES lotes(id) ON DELETE CASCADE,
    url_imagem VARCHAR(500) NOT NULL,
    titulo VARCHAR(255),
    ordem INTEGER DEFAULT 0,
    principal BOOLEAN DEFAULT false,
    data_upload TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_lote_imagens_lote_id ON lote_imagens(lote_id);
CREATE INDEX idx_lote_imagens_principal ON lote_imagens(principal);

-- Tabela de Pagamentos
CREATE TABLE pagamentos (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    lote_id UUID NOT NULL REFERENCES lotes(id) ON DELETE CASCADE,
    usuario_id UUID NOT NULL REFERENCES usuarios(id),
    valor DECIMAL(15,2) NOT NULL,
    metodo_pagamento VARCHAR(50) NOT NULL,
    status VARCHAR(20) NOT NULL DEFAULT 'Pendente',
    data_vencimento TIMESTAMP WITH TIME ZONE,
    data_pagamento TIMESTAMP WITH TIME ZONE,
    codigo_transacao VARCHAR(100),
    comprovante_url VARCHAR(500)
);

-- Índices para pagamentos
CREATE INDEX idx_pagamentos_lote_id ON pagamentos(lote_id);
CREATE INDEX idx_pagamentos_usuario_id ON pagamentos(usuario_id);
CREATE INDEX idx_pagamentos_status ON pagamentos(status);

-- Tabela de Notificações
CREATE TABLE notificacoes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    usuario_id UUID NOT NULL REFERENCES usuarios(id) ON DELETE CASCADE,
    leilao_id UUID REFERENCES leiloes(id) ON DELETE CASCADE,
    tipo VARCHAR(50) NOT NULL,
    titulo VARCHAR(255) NOT NULL,
    mensagem TEXT NOT NULL,
    lida BOOLEAN DEFAULT false,
    data_criacao TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    data_leitura TIMESTAMP WITH TIME ZONE
);

-- Índices para notificações
CREATE INDEX idx_notificacoes_usuario_id ON notificacoes(usuario_id);
CREATE INDEX idx_notificacoes_leilao_id ON notificacoes(leilao_id);
CREATE INDEX idx_notificacoes_lida ON notificacoes(lida);

-- Inserir dados iniciais de teste
INSERT INTO usuarios (cpf, nome, email, telefone, senha_hash, tipo, aprovado) VALUES
('123.456.789-00', 'Administrador Principal', 'admin@santacasaufm.com.br', '(35) 99999-9999', 'AQAAAAEAACcQAAAAEKnFH7K6Q2T4v8T3z8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8Q8x8